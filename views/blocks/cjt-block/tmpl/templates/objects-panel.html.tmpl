<?php
	// Import Wordpress pages checkbox list helpers.
	$this->importHelper('wpnavmenuwalker');
	$this->importHelper('wppageslist');	
?>
		<div class="cjpageblock">
			<div id="tabs-<?php echo $block->id; ?>" class="cjt-pages-tab">
				<ul>
					<li><a href="#tabs-<?php echo $block->id; ?>-pages"><?php echo cssJSToolbox::getText('Pages') ?></a></li>
					<li><a href="#tabs-<?php echo $block->id; ?>-posts"><?php echo cssJSToolbox::getText('Posts') ?></a></li>
					<li><a href="#tabs-<?php echo $block->id; ?>-custom-posts"><?php echo cssJSToolbox::getText('Custom Posts') ?></a></li>
					<li><a href="#tabs-<?php echo $block->id; ?>-categories"><?php echo cssJSToolbox::getText('Categories') ?></a></li>
					<li><a href="#tabs-<?php echo $block->id; ?>-other"><?php echo cssJSToolbox::getText('Other') ?></a></li>
					<li><a href="#tabs-<?php echo $block->id; ?>-advanced"><?php echo cssJSToolbox::getText('Advanced') ?></a></li>
				</ul>
				<div id="tabs-<?php echo $block->id; ?>-pages">
					<ul class="pagelist">
						<li>
							<label>
<?php						echo $this->getPinCheckbox('pinPoint', CJTBlockModel::PINS_PAGES_ALL_PAGES) ?> <?php echo cssJSToolbox::getText('All Pages') ?>
							</label>
						</li>
						<li>
							<label>
<?php						echo $this->getPinCheckbox('pinPoint', CJTBlockModel::PINS_PAGES_FRONT_PAGE) ?>
							</label> 
							<span><a href="<?php bloginfo('url') ?>" target="_blank"><?php echo cssJSToolbox::getText('Front Page') ?></a></span>
						</li>
							<?php WPPagesListHelper::show_pages_with_checkbox($block->id, $block->pages, 'page', 'pages'); ?>
					</ul>
				</div>
				<div id="tabs-<?php echo $block->id; ?>-posts">
					<ul class="pagelist">
						<li>
							<label>
<?php						echo $this->getPinCheckbox('pinPoint', CJTBlockModel::PINS_POSTS_ALL_POSTS) ?> <?php echo cssJSToolbox::getText('All Posts') ?>
							</label>
						</li>
						<li>
							<label>
<?php						echo $this->getPinCheckbox('pinPoint', CJTBlockModel::PINS_POSTS_BLOG_INDEX) ?> <?php echo cssJSToolbox::getText('Blog Index') ?>
							</label>
						</li>
						<li>
							<label>
<?php						echo $this->getPinCheckbox('pinPoint', CJTBlockModel::PINS_POSTS_RECENT) ?> <?php echo cssJSToolbox::getText('Recent Posts') ?>
							</label>
						</li>
							<?php WPPagesListHelper::show_pages_with_checkbox($block->id, $block->posts, 'post', 'posts'); ?>
					</ul>
				</div>
				
				
				<div id="tabs-<?php echo $block->id; ?>-custom-posts">
					<ul class="pagelist">
<?php
						/** For every registered custom post
						* display a list of checkboxes listed under
						* the Custom Post Label!
						*/
						// Get only custom posts.
						$wordpressBuildInTypes = array_flip(array('attachment', 'post', 'page', 'revision', 'nav_menu_item'));
						$postTypes = array_diff_key($GLOBALS['wp_post_types'], $wordpressBuildInTypes);
						$NoCustomPosts = true;
						foreach ($postTypes as $type => $postType) :
							// Get list markups into memory!
							ob_start();
							WPPagesListHelper::show_pages_with_checkbox($block->id, $block->posts, $type, 'posts'); 
							$list = ob_get_clean();
							// If there is not content on the output buffer then there is no posts inside that type!
							if ($list) :
								$NoCustomPosts = false;
?>
							<li>
								<span class="sub-list" title="<?php echo $postType->description ?>"><?php echo $postType->labels->name ?></span>
								<ul><?php echo $list ?></ul>
							</li>
<?php
							endif;
						endforeach;
						// If there is no any custom post available
						// print message.
						if ($NoCustomPosts) :
						
?>
							<li>
								<div class="list-error">
									<span class="message"><?php echo cssJSToolbox::getText('There is no Custom Posts Defined yet!') ?></span>
									<br />
									<br />
									<span class="desc">This message is displayed if there is no Custom Post types defined or there is no Posts Added under Custom Post types!</span>
								</div>
							</li>
<?php
						endif;
?>
					</ul>
				</div>
				
				
				<div id="tabs-<?php echo $block->id; ?>-categories">
					<ul class="pagelist">
						<li>
							<label>
<?php						echo $this->getPinCheckbox('pinPoint', CJTBlockModel::PINS_CATEGORIES_ALL_CATEGORIES) ?> <?php echo cssJSToolbox::getText('All Categories') ?>
							</label>
						</li>
							<?php WPPagesListHelper::show_taxonomy_with_checkbox($block->id, $block->categories); ?>
					</ul>
				</div>
				<div id="tabs-<?php echo $block->id; ?>-other">
					<ul class="pagelist">
<?php
							$list = array(
								CJTBlockModel::PINS_FRONTEND => __('Entire Website'),
								CJTBlockModel::PINS_BACKEND => __('Website Backend'),
								CJTBlockModel::PINS_SEARCH => __('Search Pages'),
								CJTBlockModel::PINS_ARCHIVE => __('All Archives'),
								CJTBlockModel::PINS_TAG => __('Tag Archives'),
								CJTBlockModel::PINS_AUTHOR => __('Author Archives'),
								CJTBlockModel::PINS_ATTACHMENT => __('Attachment Pages'),
								CJTBlockModel::PINS_404_ERROR => __('404 Error'),
							);
							foreach ($list as $value => $text) :
?>
						<li>
							<label>
<?php						echo $this->getPinCheckbox('pinPoint', $value) ?> <?php echo $text ?>
							</label>
						</li>
<?php					endforeach; ?>
					</ul>
				</div>
				<div id="tabs-<?php echo $block->id; ?>-advanced">
					<div id="advanced-accordion">
						<h3><a href="#" title="<?php echo cssJSToolbox::getText('One URL per line') ?>"><?php echo cssJSToolbox::getText('URLs') ?></a></h3>
						<div class="linklist">
							<textarea cols="31" rows="9" name="cjtoolbox[<?php echo $block->id; ?>][links]" id="cjcode-links-<?php echo $block->id; ?>"><?php echo $block->links; ?></textarea>
						</div>
						<h3><a href="#" title="<?php  echo cssJSToolbox::getText('One Expression per line') ?>"><?php echo cssJSToolbox::getText('Expressions') ?></a></h3>
						<div class="linklist">
							<textarea cols="31" rows="9" name="cjtoolbox[<?php echo $block->id; ?>][expressions]" id="cjcode-expressions-<?php echo $block->id; ?>"><?php echo $block->expressions; ?></textarea>
						</div>
					</div>
				</div>
			</div>
			<div style="clear:both;"></div>
		</div>