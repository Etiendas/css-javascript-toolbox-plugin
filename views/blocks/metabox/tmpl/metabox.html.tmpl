<?php
/**
* 
*/

// Disallow direct access.
defined('ABSPATH') or die("Access denied");

// Extend block view editor toolbox buttons.
$this->blockView->setOption(
	'editorToolboxExtension', (object) array(
		'mode' => 'inheritance',
		'toolboxFile' => $this->getPath('tmpl/templates/editor-toolbox.html.tmpl'),
		'map' => array(
			'preview' => array('reference' => 'fullscreen', 'method' => 'after'),
		),
	)
);
		
// Display as metabox without using Wordpress Metabox APIs.
if ($this->getOption('customizeMetabox')) : ?>
<div id="cjtoolbox-<?php echo $this->getBlock()->id; ?>" class="postbox">
	<div class="handlediv" title="Click to toggle"><br /></div>
	<h3 class='hndle'>
		<span><?php echo $this->getMetaboxName(); ?></span>
	</h3>
	<div class="inside">
<?php endif; ?>
		<input type="hidden" id="cjt-securityToken" value="<?php echo $this->getSecurityToken() ?>" />
<?php $this->blockView->display();
			if ($this->getOption('customizeMetabox')) : ?>
	</div>
</div>
<?php endif; ?>
<script type="text/javascript">
	// Initialize metabox.
	jQuery(jQuery.proxy(CJTBlocksPage.init, CJTBlocksPage));
</script>